<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Totem Photo - Mis Fotos</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="container">
        <div class="app-container">
            <div class="header">
                <div class="header-content">
                    <h1>Totem Photo</h1>
                    <p>Tus recuerdos</p>
                </div>

                <!-- Dropdown Menu Toggle -->
                <button class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>

                <!-- Dropdown Menu -->
                <div class="dropdown-menu">
                    <a href="photos.html" class="dropdown-item"><i class="fas fa-images"></i> Galería Principal</a>
                    <a href="take-photo.html" class="dropdown-item"><i class="fas fa-camera"></i> Tomar Foto</a>
                    <a href="qr.html" class="dropdown-item"><i class="fas fa-qrcode"></i> Escanear QR</a>
                    <a href="#" class="dropdown-item" data-modal-target="help-modal"><i
                            class="fas fa-question-circle"></i> Ayuda</a>
                    <a href="#" class="dropdown-item" data-modal-target="config-modal"><i class="fas fa-cog"></i>
                        Configuración</a>
                    <a href="index.html" class="dropdown-item"><i class="fas fa-sign-out-alt"></i> Salir</a>
                </div>
            </div>

            <div class="content">
                <div class="gallery-container">
                    <h2 class="page-title">Mis Fotos</h2>

                    <div id="gallery-grid" class="gallery-grid">
                        <!-- Photos will be loaded here dynamically -->
                    </div>

                    <div id="empty-gallery" class="empty-gallery" style="display: none;">
                        <i class="fas fa-images"></i>
                        <p>No hay fotos aún</p>
                        <p>Toma tu primera foto para comenzar</p>
                        <a href="take-photo.html" class="btn" style="max-width: 200px; margin: 20px auto;">Tomar
                            Foto</a>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <a href="take-photo.html" class="btn" style="max-width: 200px; display: inline-block;">Tomar
                            Nueva Foto</a>
                        <a href="photos.html" class="btn"
                            style="max-width: 200px; display: inline-block; margin-left: 10px;">Menú Principal</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Photo Viewer -->
    <div id="photo-viewer" class="photo-viewer">
        <button class="photo-viewer-close">&times;</button>
        <img id="viewer-image" src="" alt="Photo">
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <button class="close-modal">&times;</button>
            <h2 class="page-title">AYUDA</h2>
            <div class="page-text">
                <p>Bienvenido a la sección de ayuda de Totem Photo.</p>
                <p>Si tienes problemas para iniciar sesión, toma de fotos o cualquier otra función, no dudes en
                    contactarnos.</p>
                <p><strong>Email:</strong> support@totemphoto.com</p>
                <p><strong>Teléfono:</strong> +1 234 567 890</p>
            </div>
        </div>
    </div>

    <!-- Config Modal -->
    <div id="config-modal" class="modal">
        <div class="modal-content">
            <button class="close-modal">&times;</button>
            <h2 class="page-title">CONFIGURACIÓN</h2>
            <div class="form-container" style="box-shadow: none; padding: 0;">
                <div class="form-group">
                    <label for="language">Idioma</label>
                    <select id="language">
                        <option value="es">Español</option>
                        <option value="en">English</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="quality">Calidad de imagen</label>
                    <select id="quality">
                        <option value="high">Alta</option>
                        <option value="medium">Media</option>
                        <option value="low">Baja</option>
                    </select>
                </div>
                <div class="form-group" style="display: flex; align-items: center; gap: 10px;">
                    <input type="checkbox" id="notifications" checked style="width: auto;">
                    <label for="notifications" style="margin: 0;">Notificaciones</label>
                </div>
                <button class="btn">Guardar</button>
            </div>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script>
        // Load photos from localStorage
        function loadGallery() {
            const galleryGrid = document.getElementById('gallery-grid');
            const emptyGallery = document.getElementById('empty-gallery');
            const photos = JSON.parse(localStorage.getItem('totemPhotos') || '[]');

            if (photos.length === 0) {
                emptyGallery.style.display = 'block';
                galleryGrid.style.display = 'none';
                return;
            }

            emptyGallery.style.display = 'none';
            galleryGrid.style.display = 'grid';
            galleryGrid.innerHTML = '';

            photos.reverse().forEach((photo, index) => {
                const item = document.createElement('div');
                item.className = 'gallery-item';
                item.innerHTML = `
                    <img src="${photo.data}" alt="Photo ${index + 1}">
                    <div class="gallery-item-actions">
                        <button onclick="viewPhoto(${photo.id})" title="Ver"><i class="fas fa-eye"></i></button>
                        <button onclick="downloadPhoto(${photo.id})" title="Descargar"><i class="fas fa-download"></i></button>
                        <button onclick="deletePhoto(${photo.id})" title="Eliminar"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                galleryGrid.appendChild(item);
            });
        }

        // View photo in fullscreen
        function viewPhoto(id) {
            const photos = JSON.parse(localStorage.getItem('totemPhotos') || '[]');
            const photo = photos.find(p => p.id === id);
            if (photo) {
                const viewer = document.getElementById('photo-viewer');
                const img = document.getElementById('viewer-image');
                img.src = photo.data;
                viewer.classList.add('show');
            }
        }

        // Download photo
        function downloadPhoto(id) {
            const photos = JSON.parse(localStorage.getItem('totemPhotos') || '[]');
            const photo = photos.find(p => p.id === id);
            if (photo) {
                const link = document.createElement('a');
                link.href = photo.data;
                link.download = `totem-photo-${id}.jpg`;
                link.click();
            }
        }

        // Delete photo
        function deletePhoto(id) {
            if (confirm('¿Estás seguro de que quieres eliminar esta foto?')) {
                let photos = JSON.parse(localStorage.getItem('totemPhotos') || '[]');
                photos = photos.filter(p => p.id !== id);
                localStorage.setItem('totemPhotos', JSON.stringify(photos));
                loadGallery();
            }
        }

        // Close photo viewer
        document.querySelector('.photo-viewer-close').addEventListener('click', function () {
            document.getElementById('photo-viewer').classList.remove('show');
        });

        document.getElementById('photo-viewer').addEventListener('click', function (e) {
            if (e.target === this) {
                this.classList.remove('show');
            }
        });

        // Load gallery on page load
        loadGallery();
    </script>
</body>

</html>